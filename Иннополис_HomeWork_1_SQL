--Найти самый дорогой товар. Вывести имя товара и его цену
SELECT Goods.name, Prices.value FROM Goods
JOIN Prices ON Goods.id = Prices.goods_id
WHERE Prices.value = (SELECT MAX (value) FROM Prices)


--Найти товары с нулевым остатком. Вывести имя товара и его цену
SELECT Goods.name, Prices.value FROM Goods
JOIN Prices ON Goods.id = Prices.goods_id
JOIN Quantity ON Goods.id = Quantity.goods_id
WHERE Quantity.value = 0


--Найти производителя с самой большой средней ценой за товары. Вывести имя производителя и среднюю стоимость
SELECT Manufacturer.name, ROUND(AVG(Prices.value),2) avg_v FROM Goods
JOIN Prices ON Prices.goods_id = Goods.id
JOIN Suppliers ON Suppliers.id = Goods.supplier_id 
JOIN Manufacturer ON Manufacturer.id = Suppliers.manufacturer_id
JOIN Quantity ON Quantity.goods_id = Goods.id
GROUP BY Manufacturer.name
ORDER BY avg_v DESC
LIMIT 1


--Найти производителя с самой большой средней ценой за товары. Вывести имя производителя и среднюю стоимость
SELECT Manufacturer.name, ROUND(AVG(Prices.value),2) FROM Goods
JOIN Prices ON Prices.goods_id = Goods.id
JOIN Suppliers ON Suppliers.id = Goods.supplier_id 
JOIN Manufacturer ON Manufacturer.id = Suppliers.manufacturer_id
JOIN Quantity ON Quantity.goods_id = Goods.id
GROUP BY Manufacturer.name
HAVING ROUND(AVG(Prices.value),2) = (SELECT MAX(avg) FROM (SELECT Manufacturer.name, ROUND(AVG(Prices.value),2) avg FROM Goods
JOIN Prices ON Goods.id = Prices.goods_id
JOIN Suppliers ON Goods.supplier_id = Suppliers.id
JOIN Manufacturer ON Manufacturer.id = Suppliers.manufacturer_id
GROUP BY Manufacturer.name) x)


--Найти все товары производителей из Москвы. Вывести имена товаров, их цены и имена производителей
SELECT Manufacturer.name as Manufacturer_name, Goods.name as Goods_name, Prices.value FROM Goods
JOIN Prices ON Goods.id = Prices.goods_id
JOIN Suppliers ON Suppliers.id = Goods.supplier_id
JOIN Manufacturer ON Manufacturer.id = Suppliers.manufacturer_id
WHERE Manufacturer.location = 'Moscow'
